# ğŸ›ï¸ æ¶æ„è®¾è®¡

Berry API é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œç”±5ä¸ªæ ¸å¿ƒæ¨¡å—ç»„æˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Berry API Gateway                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   berry-api     â”‚  berry-relay    â”‚ berry-loadbalanceâ”‚berry-core â”‚
â”‚   WebæœåŠ¡å±‚     â”‚   è¯·æ±‚è½¬å‘å±‚    â”‚   è´Ÿè½½å‡è¡¡å±‚     â”‚  æ ¸å¿ƒåº“   â”‚
â”‚                 â”‚                 â”‚                 â”‚           â”‚
â”‚ â€¢ HTTPè·¯ç”±      â”‚ â€¢ è¯·æ±‚è½¬å‘      â”‚ â€¢ åç«¯é€‰æ‹©      â”‚ â€¢ é…ç½®ç®¡ç†â”‚
â”‚ â€¢ è®¤è¯ä¸­é—´ä»¶    â”‚ â€¢ æµå¼å¤„ç†      â”‚ â€¢ å¥åº·æ£€æŸ¥      â”‚ â€¢ è®¤è¯ç³»ç»Ÿâ”‚
â”‚ â€¢ é™æ€æ–‡ä»¶      â”‚ â€¢ é”™è¯¯å¤„ç†      â”‚ â€¢ æŒ‡æ ‡æ”¶é›†      â”‚ â€¢ å…±äº«ç±»å‹â”‚
â”‚ â€¢ ç®¡ç†æ¥å£      â”‚ â€¢ åè®®é€‚é…      â”‚ â€¢ ç­–ç•¥å®ç°      â”‚ â€¢ å·¥å…·å‡½æ•°â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      berry-cli        â”‚
                    â”‚     å‘½ä»¤è¡Œå·¥å…·        â”‚
                    â”‚                       â”‚
                    â”‚ â€¢ é…ç½®éªŒè¯            â”‚
                    â”‚ â€¢ å¥åº·æ£€æŸ¥            â”‚
                    â”‚ â€¢ æŒ‡æ ‡æŸ¥çœ‹            â”‚
                    â”‚ â€¢ åç«¯æµ‹è¯•            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
graph TD
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B[è®¤è¯ä¸­é—´ä»¶]
    B --> C{è®¤è¯æˆåŠŸ?}
    C -->|å¦| D[è¿”å›401é”™è¯¯]
    C -->|æ˜¯| E[æƒé™æ£€æŸ¥]
    E --> F{æœ‰æƒé™?}
    F -->|å¦| G[è¿”å›403é”™è¯¯]
    F -->|æ˜¯| H[é€Ÿç‡é™åˆ¶æ£€æŸ¥]
    H --> I{æœªè¶…é™?}
    I -->|å¦| J[è¿”å›429é”™è¯¯]
    I -->|æ˜¯| K[è´Ÿè½½å‡è¡¡é€‰æ‹©]
    K --> L[åç«¯å¥åº·æ£€æŸ¥]
    L --> M{åç«¯å¥åº·?}
    M -->|å¦| N[é‡è¯•å…¶ä»–åç«¯]
    M -->|æ˜¯| O[è½¬å‘è¯·æ±‚]
    O --> P[å¤„ç†å“åº”]
    P --> Q{æµå¼å“åº”?}
    Q -->|æ˜¯| R[SSEæµå¼ä¼ è¾“]
    Q -->|å¦| S[JSONå“åº”]
    R --> T[è¿”å›å®¢æˆ·ç«¯]
    S --> T
    N --> K
```

### ğŸ§© æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ | æŠ€æœ¯æ ˆ |
|------|------|--------|
| **berry-api** | WebæœåŠ¡å±‚ï¼Œæä¾›HTTP API | Axum, Tower |
| **berry-relay** | è¯·æ±‚è½¬å‘å±‚ï¼Œå¤„ç†ä¸Šæ¸¸è¯·æ±‚ | Reqwest, Tokio |
| **berry-loadbalance** | è´Ÿè½½å‡è¡¡å±‚ï¼Œå®ç°é€‰æ‹©ç­–ç•¥ | è‡ªç ”ç®—æ³•, Metrics |
| **berry-core** | æ ¸å¿ƒåº“ï¼Œé…ç½®å’Œè®¤è¯ç®¡ç† | Serde, TOML |
| **berry-cli** | å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿ç»´ç®¡ç† | Clap, é…ç½®éªŒè¯ |
